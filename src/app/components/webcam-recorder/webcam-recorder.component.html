<div class="webcam-recorder-container">
  <div class="main-video-column">
    <div class="webcam-container">
      <video #videoElement class="main-video"></video>

      <div class="bandwidth-overlay" *ngIf="isMeasuringBandwidth">
        <svg
          width="100"
          height="100"
          viewBox="0 0 112 112"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="custom-spinner"
        >
          <path
            d="M106 56C106 62.5661 104.707 69.0679 102.194 75.1342C99.6812 81.2005 95.9983 86.7124 91.3553 91.3553C86.7124 95.9983 81.2004 99.6812 75.1342 102.194C69.0679 104.707 62.5661 106 56 106C49.4339 106 42.9321 104.707 36.8658 102.194C30.7995 99.6812 25.2876 95.9983 20.6447 91.3553C16.0017 86.7124 12.3188 81.2004 9.80602 75.1342C7.29329 69.0679 6 62.5661 6 56C6 49.4339 7.29329 42.9321 9.80603 36.8658C12.3188 30.7995 16.0017 25.2876 20.6447 20.6447C25.2876 16.0017 30.7996 12.3188 36.8658 9.80602C42.9321 7.29329 49.4339 6 56 6C62.5661 6 69.0679 7.29329 75.1342 9.80603C81.2005 12.3188 86.7124 16.0017 91.3553 20.6447C95.9983 25.2876 99.6812 30.7996 102.194 36.8658C104.707 42.9321 106 49.4339 106 56L106 56Z"
            stroke="#E5E7EB"
            stroke-width="12"
          />
          <g clip-path="url(#paint0_angular_18_289_clip_path)">
            <g transform="matrix(0 0.05 -0.05 0 56 56)">
              <foreignObject x="-1240" y="-1240" width="2480" height="2480">
                <div
                  xmlns="http://www.w3.org/1999/xhtml"
                  style="
                    background: conic-gradient(
                      from 90deg,
                      rgba(36, 36, 36, 1) 0deg,
                      rgba(255, 255, 255, 1) 360deg
                    );
                    height: 100%;
                    width: 100%;
                    opacity: 1;
                  "
                ></div>
              </foreignObject>
            </g>
          </g>
          <path
            d="M102.194 75.1342L96.6507 72.8381L102.194 75.1342ZM91.3553 91.3553L87.1127 87.1127L91.3553 91.3553ZM56 106V100V106ZM36.8658 102.194L39.1619 96.6507L36.8658 102.194ZM20.6447 91.3553L24.8873 87.1127L20.6447 91.3553ZM9.80602 75.1342L15.3493 72.8381L9.80602 75.1342ZM6 56H12H6ZM9.80603 36.8658L15.3493 39.1619L9.80603 36.8658ZM20.6447 20.6447L24.8873 24.8873L20.6447 20.6447ZM36.8658 9.80602L39.1619 15.3493L36.8658 9.80602ZM56 6V12V6ZM75.1342 9.80603L72.8381 15.3493L75.1342 9.80603ZM91.3553 20.6447L87.1127 24.8873L91.3553 20.6447ZM102.194 36.8658L107.737 34.5697L102.194 36.8658ZM100 56C100 61.7782 98.8619 67.4997 96.6507 72.8381L107.737 77.4303C110.552 70.636 112 63.354 112 56H100ZM96.6507 72.8381C94.4395 78.1764 91.1985 83.0269 87.1127 87.1127L95.598 95.598C100.798 90.3979 104.923 84.2245 107.737 77.4303L96.6507 72.8381ZM87.1127 87.1127C83.0269 91.1985 78.1764 94.4395 72.8381 96.6507L77.4303 107.737C84.2245 104.923 90.3979 100.798 95.598 95.598L87.1127 87.1127ZM72.8381 96.6507C67.4997 98.8619 61.7782 100 56 100V112C63.354 112 70.636 110.552 77.4303 107.737L72.8381 96.6507ZM56 100C50.2218 100 44.5003 98.8619 39.1619 96.6507L34.5697 107.737C41.364 110.552 48.646 112 56 112V100ZM39.1619 96.6507C33.8236 94.4395 28.9731 91.1985 24.8873 87.1127L16.402 95.598C21.6021 100.798 27.7755 104.923 34.5697 107.737L39.1619 96.6507ZM24.8873 87.1127C20.8015 83.0269 17.5605 78.1764 15.3493 72.8381L4.26274 77.4303C7.07701 84.2245 11.2019 90.3979 16.402 95.598L24.8873 87.1127ZM15.3493 72.8381C13.1381 67.4997 12 61.7782 12 56H0C-4.76837e-07 63.354 1.44848 70.636 4.26274 77.4303L15.3493 72.8381ZM12 56C12 50.2218 13.1381 44.5003 15.3493 39.1619L4.26275 34.5697C1.44848 41.364 4.76837e-07 48.646 0 56H12ZM15.3493 39.1619C17.5605 33.8236 20.8015 28.9731 24.8873 24.8873L16.402 16.402C11.2019 21.6021 7.07701 27.7755 4.26275 34.5697L15.3493 39.1619ZM24.8873 24.8873C28.9731 20.8015 33.8236 17.5605 39.1619 15.3493L34.5697 4.26274C27.7755 7.07701 21.6021 11.2019 16.402 16.402L24.8873 24.8873ZM39.1619 15.3493C44.5003 13.1381 50.2218 12 56 12V0C48.646 -9.53674e-07 41.364 1.44848 34.5697 4.26274L39.1619 15.3493ZM56 12C61.7782 12 67.4998 13.1381 72.8381 15.3493L77.4303 4.26275C70.636 1.44848 63.354 9.53674e-07 56 0V12ZM72.8381 15.3493C78.1764 17.5605 83.0269 20.8015 87.1127 24.8873L95.598 16.402C90.3979 11.2019 84.2245 7.07701 77.4303 4.26275L72.8381 15.3493ZM87.1127 24.8873C91.1985 28.9731 94.4395 33.8236 96.6507 39.1619L107.737 34.5697C104.923 27.7755 100.798 21.6021 95.598 16.402L87.1127 24.8873ZM96.6507 39.1619C98.8619 44.5003 100 50.2218 100 56L112 56C112 48.646 110.552 41.364 107.737 34.5697L96.6507 39.1619ZM112 56V56H100V56H112Z"
            data-figma-gradient-fill="{&#34;type&#34;:&#34;GRADIENT_ANGULAR&#34;,&#34;stops&#34;:[{&#34;color&#34;:{&#34;r&#34;:0.14117647707462311,&#34;g&#34;:0.14117647707462311,&#34;b&#34;:0.14117647707462311,&#34;a&#34;:1.0},&#34;position&#34;:0.0},{&#34;color&#34;:{&#34;r&#34;:1.0,&#34;g&#34;:1.0,&#34;b&#34;:1.0,&#34;a&#34;:1.0},&#34;position&#34;:1.0}],&#34;stopsVar&#34;:[{&#34;color&#34;:{&#34;r&#34;:0.14117647707462311,&#34;g&#34;:0.14117647707462311,&#34;b&#34;:0.14117647707462311,&#34;a&#34;:1.0},&#34;position&#34;:0.0},{&#34;color&#34;:{&#34;r&#34;:1.0,&#34;g&#34;:1.0,&#34;b&#34;:1.0,&#34;a&#34;:1.0},&#34;position&#34;:1.0}],&#34;transform&#34;:{&#34;m00&#34;:-6.1232553858099614e-15,&#34;m01&#34;:-100.0,&#34;m02&#34;:106.0,&#34;m10&#34;:100.0,&#34;m11&#34;:-6.1232553858099614e-15,&#34;m12&#34;:6.0},&#34;opacity&#34;:1.0,&#34;blendMode&#34;:&#34;NORMAL&#34;,&#34;visible&#34;:true}"
          />
          <defs>
            <clipPath id="paint0_angular_18_289_clip_path">
              <path
                d="M102.194 75.1342L96.6507 72.8381L102.194 75.1342ZM91.3553 91.3553L87.1127 87.1127L91.3553 91.3553ZM56 106V100V106ZM36.8658 102.194L39.1619 96.6507L36.8658 102.194ZM20.6447 91.3553L24.8873 87.1127L20.6447 91.3553ZM9.80602 75.1342L15.3493 72.8381L9.80602 75.1342ZM6 56H12H6ZM9.80603 36.8658L15.3493 39.1619L9.80603 36.8658ZM20.6447 20.6447L24.8873 24.8873L20.6447 20.6447ZM36.8658 9.80602L39.1619 15.3493L36.8658 9.80602ZM56 6V12V6ZM75.1342 9.80603L72.8381 15.3493L75.1342 9.80603ZM91.3553 20.6447L87.1127 24.8873L91.3553 20.6447ZM102.194 36.8658L107.737 34.5697L102.194 36.8658ZM100 56C100 61.7782 98.8619 67.4997 96.6507 72.8381L107.737 77.4303C110.552 70.636 112 63.354 112 56H100ZM96.6507 72.8381C94.4395 78.1764 91.1985 83.0269 87.1127 87.1127L95.598 95.598C100.798 90.3979 104.923 84.2245 107.737 77.4303L96.6507 72.8381ZM87.1127 87.1127C83.0269 91.1985 78.1764 94.4395 72.8381 96.6507L77.4303 107.737C84.2245 104.923 90.3979 100.798 95.598 95.598L87.1127 87.1127ZM72.8381 96.6507C67.4997 98.8619 61.7782 100 56 100V112C63.354 112 70.636 110.552 77.4303 107.737L72.8381 96.6507ZM56 100C50.2218 100 44.5003 98.8619 39.1619 96.6507L34.5697 107.737C41.364 110.552 48.646 112 56 112V100ZM39.1619 96.6507C33.8236 94.4395 28.9731 91.1985 24.8873 87.1127L16.402 95.598C21.6021 100.798 27.7755 104.923 34.5697 107.737L39.1619 96.6507ZM24.8873 87.1127C20.8015 83.0269 17.5605 78.1764 15.3493 72.8381L4.26274 77.4303C7.07701 84.2245 11.2019 90.3979 16.402 95.598L24.8873 87.1127ZM15.3493 72.8381C13.1381 67.4997 12 61.7782 12 56H0C-4.76837e-07 63.354 1.44848 70.636 4.26274 77.4303L15.3493 72.8381ZM12 56C12 50.2218 13.1381 44.5003 15.3493 39.1619L4.26275 34.5697C1.44848 41.364 4.76837e-07 48.646 0 56H12ZM15.3493 39.1619C17.5605 33.8236 20.8015 28.9731 24.8873 24.8873L16.402 16.402C11.2019 21.6021 7.07701 27.7755 4.26275 34.5697L15.3493 39.1619ZM24.8873 24.8873C28.9731 20.8015 33.8236 17.5605 39.1619 15.3493L34.5697 4.26274C27.7755 7.07701 21.6021 11.2019 16.402 16.402L24.8873 24.8873ZM39.1619 15.3493C44.5003 13.1381 50.2218 12 56 12V0C48.646 -9.53674e-07 41.364 1.44848 34.5697 4.26274L39.1619 15.3493ZM56 12C61.7782 12 67.4998 13.1381 72.8381 15.3493L77.4303 4.26275C70.636 1.44848 63.354 9.53674e-07 56 0V12ZM72.8381 15.3493C78.1764 17.5605 83.0269 20.8015 87.1127 24.8873L95.598 16.402C90.3979 11.2019 84.2245 7.07701 77.4303 4.26275L72.8381 15.3493ZM87.1127 24.8873C91.1985 28.9731 94.4395 33.8236 96.6507 39.1619L107.737 34.5697C104.923 27.7755 100.798 21.6021 95.598 16.402L87.1127 24.8873ZM96.6507 39.1619C98.8619 44.5003 100 50.2218 100 56L112 56C112 48.646 110.552 41.364 107.737 34.5697L96.6507 39.1619ZM112 56V56H100V56H112Z"
              />
            </clipPath>
          </defs>
        </svg>
      </div>

      <div class="controls" *ngIf="!isMeasuringBandwidth">
        <button class="settings-button" (click)="toggleSettings()">
          <svg
            *ngIf="!(isSettingsOpen$ | async)"
            width="40"
            height="40"
            viewBox="0 0 40 40"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M23.6802 8.04998C24.4357 8.28331 25.1579 8.58331 25.8468 8.94998L28.9018 7.11665C29.2204 6.92558 29.5936 6.84641 29.9623 6.89171C30.331 6.937 30.674 7.10416 30.9368 7.36665L32.6335 9.06331C32.896 9.32615 33.0631 9.66914 33.1084 10.0378C33.1537 10.4065 33.0746 10.7798 32.8835 11.0983L31.0502 14.1533C31.4168 14.8422 31.7168 15.5644 31.9502 16.32L35.4052 17.185C35.7656 17.2753 36.0855 17.4834 36.3141 17.7763C36.5427 18.0692 36.6668 18.4301 36.6668 18.8016V21.1983C36.6668 21.5699 36.5427 21.9308 36.3141 22.2237C36.0855 22.5166 35.7656 22.7247 35.4052 22.815L31.9502 23.68C31.7168 24.4355 31.4168 25.1578 31.0502 25.8466L32.8835 28.9016C33.0746 29.2202 33.1537 29.5935 33.1084 29.9621C33.0631 30.3308 32.896 30.6738 32.6335 30.9366L30.9368 32.6333C30.674 32.8958 30.331 33.063 29.9623 33.1083C29.5936 33.1535 29.2204 33.0744 28.9018 32.8833L25.8468 31.05C25.1579 31.4166 24.4357 31.7166 23.6802 31.95L22.8152 35.405C22.7249 35.7654 22.5167 36.0853 22.2238 36.3139C21.9309 36.5425 21.57 36.6666 21.1985 36.6666H18.8018C18.4303 36.6666 18.0694 36.5425 17.7765 36.3139C17.4836 36.0853 17.2754 35.7654 17.1852 35.405L16.3202 31.95C15.5713 31.7186 14.8459 31.4172 14.1535 31.05L11.0985 32.8833C10.7799 33.0744 10.4067 33.1535 10.038 33.1083C9.66932 33.063 9.32633 32.8958 9.0635 32.6333L7.36683 30.9366C7.10434 30.6738 6.93718 30.3308 6.89189 29.9621C6.8466 29.5935 6.92577 29.2202 7.11683 28.9016L8.95016 25.8466C8.5829 25.1542 8.28157 24.4288 8.05016 23.68L4.59516 22.815C4.23503 22.7248 3.91533 22.5169 3.68677 22.2243C3.45821 21.9317 3.33388 21.5712 3.3335 21.2V18.8033C3.33351 18.4318 3.45767 18.0709 3.68626 17.778C3.91484 17.4851 4.23475 17.2769 4.59516 17.1866L8.05016 16.3216C8.2835 15.5661 8.5835 14.8439 8.95016 14.155L7.11683 11.1C6.92577 10.7814 6.8466 10.4082 6.89189 10.0395C6.93718 9.6708 7.10434 9.32781 7.36683 9.06498L9.0635 7.36665C9.32633 7.10416 9.66932 6.937 10.038 6.89171C10.4067 6.84641 10.7799 6.92558 11.0985 7.11665L14.1535 8.94998C14.8424 8.58331 15.5646 8.28331 16.3202 8.04998L17.1852 4.59498C17.2754 4.23485 17.4833 3.91514 17.7758 3.68658C18.0684 3.45802 18.4289 3.33369 18.8002 3.33331H21.1968C21.5684 3.33332 21.9293 3.45748 22.2222 3.68607C22.5151 3.91466 22.7232 4.23457 22.8135 4.59498L23.6802 8.04998ZM20.0002 26.6666C21.7683 26.6666 23.464 25.9643 24.7142 24.714C25.9645 23.4638 26.6668 21.7681 26.6668 20C26.6668 18.2319 25.9645 16.5362 24.7142 15.2859C23.464 14.0357 21.7683 13.3333 20.0002 13.3333C18.2321 13.3333 16.5364 14.0357 15.2861 15.2859C14.0359 16.5362 13.3335 18.2319 13.3335 20C13.3335 21.7681 14.0359 23.4638 15.2861 24.714C16.5364 25.9643 18.2321 26.6666 20.0002 26.6666Z"
              fill="white"
            />
          </svg>
          <svg
            class="close-button"
            *ngIf="isSettingsOpen$ | async"
            width="26"
            height="26"
            viewBox="0 0 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M2 28L28 2M2 2L28 28"
              stroke="white"
              stroke-width="3"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </button>

        <div class="quality-menu" [class.open]="isSettingsOpen$ | async">
          <div
            class="quality-option"
            *ngFor="let quality of qualities"
            (click)="selectQuality(quality.value)"
            [class.selected]="quality.value === (currentQuality$ | async)"
          >
            <span class="quality-label">
              <span class="quality-number">{{ quality.label.number }} </span
              >{{ quality.label.text }}
            </span>
            <svg
              *ngIf="quality.value === (currentQuality$ | async)"
              width="18"
              height="14"
              viewBox="0 0 18 14"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M6.09961 13.166C6.45117 13.5176 7.04883 13.5176 7.40039 13.166L17.7363 2.83008C18.0879 2.47852 18.0879 1.88086 17.7363 1.5293L16.4707 0.263672C16.1191 -0.0878906 15.5566 -0.0878906 15.2051 0.263672L6.76758 8.70117L2.79492 4.76367C2.44336 4.41211 1.88086 4.41211 1.5293 4.76367L0.263672 6.0293C-0.0878906 6.38086 -0.0878906 6.97852 0.263672 7.33008L6.09961 13.166Z"
                fill="#33AB30"
              />
            </svg>
          </div>
        </div>

        <button *ngIf="!(isRecording$ | async)" class="record-button" (click)="toggleRecording()">
          <svg
            width="60"
            height="60"
            viewBox="0 0 60 60"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <circle cx="30" cy="30" r="30" fill="white" />
            <circle cx="30" cy="30" r="14" fill="#FF0000" />
          </svg>
        </button>

        <div *ngIf="isRecording$ | async" class="recording-controls">
          <button class="stop-button" (click)="toggleRecording()">
            <svg
              width="61"
              height="60"
              viewBox="0 0 61 60"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <circle cx="30.25" cy="30" r="28.5" fill="white" stroke="#5061D0" stroke-width="3" />
              <rect x="19.25" y="19" width="22" height="22" rx="4" fill="#5061D0" />
            </svg>
          </button>
          <div class="recording-timer">
            <span class="timer-text">{{ (recordingTime$ | async) ?? 0 }}s</span>
            <div class="timer-progress">
              <div
                class="progress-bar"
                [style.width.%]="((recordingTime$ | async) ?? 0) * 10"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="recorded-videos-column">
    <div class="videos-list" *ngIf="!isMeasuringBandwidth">
      <div class="empty-state" *ngIf="!(hasRecordedVideos$ | async)">
        <svg
          width="34"
          height="23"
          viewBox="0 0 34 23"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M5.33333 0.666656C4.11776 0.666656 2.95197 1.14954 2.09243 2.00908C1.23289 2.86863 0.75 4.03441 0.75 5.24999V17.75C0.75 18.9656 1.23289 20.1314 2.09243 20.9909C2.95197 21.8504 4.11776 22.3333 5.33333 22.3333H19.5C20.7156 22.3333 21.8814 21.8504 22.7409 20.9909C23.6004 20.1314 24.0833 18.9656 24.0833 17.75V15.0933L29.7817 20.1683C31.1233 21.3633 33.25 20.41 33.25 18.6117V3.77499C33.25 1.97499 31.1233 1.02332 29.7817 2.21832L24.0833 7.29332V5.24999C24.0833 4.03441 23.6004 2.86863 22.7409 2.00908C21.8814 1.14954 20.7156 0.666656 19.5 0.666656H5.33333Z"
            fill="white"
            fill-opacity="0.8"
          />
        </svg>
        <p>There are no recorded videos yet</p>
      </div>
      <app-video-list *ngIf="hasRecordedVideos$ | async"></app-video-list>
    </div>
  </div>
</div>
